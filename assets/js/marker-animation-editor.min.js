/*!
 * marker-animation-editor 1.7.4
 * Copyright (c) 2019 Technote <technote.space@gmail.com> (https://technote.space)
 * License: GPL-3.0
 */!function(a){var t={};function e(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return a[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=a,e.c=t,e.d=function(a,t,n){e.o(a,t)||Object.defineProperty(a,t,{enumerable:!0,get:n})},e.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},e.t=function(a,t){if(1&t&&(a=e(a)),8&t)return a;if(4&t&&"object"==typeof a&&a&&a.__esModule)return a;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:a}),2&t&&"string"!=typeof a)for(var i in a)e.d(n,i,function(t){return a[t]}.bind(null,i));return n},e.n=function(a){var t=a&&a.__esModule?function(){return a.default}:function(){return a};return e.d(t,"a",t),t},e.o=function(a,t){return Object.prototype.hasOwnProperty.call(a,t)},e.p="",e(e.s=0)}([function(a,t,e){"use strict";var n,i=e(1),r=(n=i)&&n.__esModule?n:{default:n},o=e(2);(0,r.default)(function(){var a=[],t=(0,o.getDetailSettings)(),e=t.attrs,n=t.defaultStyle,i=t.body;tinymce.create("tinymce.plugins.marker_animation_button",{init:function(t){t.addButton("marker_animation",{title:marker_animation_params.title,icon:"icon highlight-icon",onclick:function(){u(t,null)},onPostRender:function(){c(t,this)}}),t.addButton("marker_animation_detail",{title:marker_animation_params.detail_title,icon:"icon highlight-icon",onclick:function(){u(t,function(){var a=r.default.Deferred();return t.windowManager.open({title:marker_animation_params.title,body:i,onSubmit:function(t){a.resolve(l(t.data))},onClose:function(){a.reject()}}),a})},onPostRender:function(){c(t,this)}}),Object.keys(marker_animation_params.settings).forEach(function(a){m(t,marker_animation_params.settings[a])}),t.on("init",function(){n.forEach(function(a){s(t,a.name,a.value),"color"===a.name&&s(t,a.name,a.value,!0,void 0,!0)}),t.dom.select("."+marker_animation_params.class).forEach(function(a){Object.keys(a.dataset).forEach(function(e){e.substring(0,marker_animation_params.prefix.length)===marker_animation_params.prefix&&s(t,e.slice(marker_animation_params.prefix.length),a.dataset[e],!0)})}),a.length=0,a.push("marker_animation"),t.formatter.register("marker_animation",{inline:"span",classes:[marker_animation_params.class],attributes:e}),Object.keys(marker_animation_params.settings).forEach(function(a){d(t,marker_animation_params.settings[a],n)})})},createControl:function(){return null}});var s=function(a,t,e,n,i,r){(0,o._addStyle)(function(i,s,l){var u=(marker_animation_params.is_block_editor?"body #editor":"body")+" ."+i;!r&&n&&(u+="["+(0,o.getDataName)(t,!0)+'="'+e+'"]'),n&&"color"===l&&(u+="["+(0,o.getDataName)("stripe",!0)+'="'+(marker_animation_params.details.stripe.detail.value?"false":"true")+'"]'),a.dom.addStyle(u+" { "+s+" }")},t,e,i,n)},l=function(a){var t={};return Object.keys(a).forEach(function(e){var n=a[e],i=(0,o.parseInputValue)(n,e);i&&(t[i.name]=i.value)}),t},u=function(t,n,i,o){var l=t.selection.getNode(),u=t.selection.getSel().focusNode.classList;void 0===i&&(i="marker_animation"),void 0===o&&(o=marker_animation_params.class),u&&u.contains(o)&&(l=t.selection.getSel().focusNode);var c=(0,r.default)(l),m=t.selection.getBookmark();if(c.hasClass(o))Object.keys(e).forEach(function(a){l.removeAttribute(a)}),a.forEach(function(a){try{t.formatter.remove(a,void 0,l)}catch(a){}}),t.selection.moveToBookmark(m);else{var d=void 0;n?d=n():(d=r.default.Deferred(),setTimeout(function(){d.resolve({})},1)),d.done(function(a){!function(a,t){Object.keys(t).forEach(function(e){s(a,e,t[e],!0)})}(t,a);var e=t.selection.getContent();t.formatter.apply(i,a,""===e?l:null),t.selection.moveToBookmark(m)})}},c=function(a,t,e){void 0===e&&(e=marker_animation_params.class),a.on("NodeChange",function(a){t.active(a.element.classList.contains(e))})},m=function(a,t){var e=t.id,n="marker_animation-"+e;t.options.is_valid_button&&a.addButton(n,{title:t.title,icon:"icon highlight-icon setting-"+e,onclick:function(){u(a,null,n,t.options.class)},onPostRender:function(){c(a,this,t.options.class)}}),t.options.is_valid_style&&a.addCommand("marker_animation_preset_color"+e,function(){u(a,null,n,t.options.class)})},d=function(t,n,i){var r="marker_animation-"+n.id;a.push(r),t.formatter.register(r,{inline:"span",classes:[n.options.class],attributes:e}),s(t,"display","inline",!1,n.options.class),s(t,"background-position","left -100% center",!1,n.options.class),s(t,"background-repeat","repeat-x",!1,n.options.class),i.forEach(function(a){s(t,a.name,a.value,!1,n.options.class)}),Object.keys(n.options).forEach(function(a){s(t,a,n.options[a],!1,n.options.class)})};tinymce.PluginManager.add("marker_animation_button_plugin",tinymce.plugins.marker_animation_button)})},function(a,t){a.exports=jQuery},function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),void 0===marker_animation_params.added_style&&(marker_animation_params.added_style={});var n=function(a,t,e){var n=marker_animation_params.details[t],r=i(t);if("input/checkbox"===n.form)if(a){if(!e&&n.attributes["data-value"])return!1;a=void 0===n.attributes["data-option_value-1"]?a:n.attributes["data-option_value-1"]}else{if(!e&&!n.attributes["data-value"])return!1;a=void 0===n.attributes["data-option_value-0"]?a:n.attributes["data-option_value-0"]}return!!(e||void 0!==a&&""!==a&&a!==n.attributes["data-value"])&&{name:r,key:t,value:a}},i=function(a){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=marker_animation_params.details[a],n=e&&e.attributes&&e.attributes["data-option_name"]?e.attributes["data-option_name"]:a;return t?"data-"+marker_animation_params.prefix+n:n},r=function(a){return function(t){return void 0===t?"":o(t[a])}},o=function(a){return void 0===a?"":null===a?"null":a+""};t._addStyle=function a(t,e,n,i,r,o){if(void 0===i&&(i=marker_animation_params.class),!(marker_animation_params.added_style[i]&&marker_animation_params.added_style[i][e]&&marker_animation_params.added_style[i][e][n])){var s=null;"color"!==e?("color-normal"===e?s="background-image:linear-gradient(to right,rgba(255,255,255,0) 50%,"+n+" 50%)":"color-stripe"===e?s="background-image:repeating-linear-gradient(-45deg,"+n+","+n+" 2px,transparent 2px,transparent 4px)":"thickness"===e?s="background-size:200% "+n:"font_weight"===e||"bold"===e?s="font-weight:"+(n&&"null"!==n?n:"normal"):"padding_bottom"===e?s="padding-bottom:"+n:"display"===e?s="display:"+n:"background-position"===e?s="background-position:"+n:"background-repeat"===e&&(s="background-repeat:"+n),s&&t(i,s,o),marker_animation_params.added_style[i]||(marker_animation_params.added_style[i]={}),marker_animation_params.added_style[i][e]||(marker_animation_params.added_style[i][e]={}),marker_animation_params.added_style[i][e][n]=!0):marker_animation_params.details.stripe.detail.value?(a(t,e+"-stripe",n,i),r&&a(t,e+"-normal",n,i,!1,e)):(a(t,e+"-normal",n,i),r&&a(t,e+"-stripe",n,i,!1,e))}},t.parseInputValue=n,t.getDetailSettings=function(){var a=[],t=[],e={};return Object.keys(marker_animation_params.details).forEach(function(o){var s=marker_animation_params.details[o];if(!s.ignore){var l=void 0,u=void 0;if("input/checkbox"===s.form)l="checked"===s.attributes.checked,u={type:"checkbox",name:o,label:s.title,checked:l};else if(marker_animation_params.is_valid_color_picker&&"color"===s.form)l=s.value,u={type:"colorpicker",name:o,label:s.title,value:l};else if("select"===s.form){var c=[];Object.keys(s.options).forEach(function(a){c.push({text:s.options[a],label:s.options[a],value:a})}),l=s.value,u={type:"listbox",name:o,label:s.title,values:c,value:l}}else l=s.value,u={type:"textbox",name:o,label:s.title,value:l};e[i(o,!0)]=r(i(o)),t.push(n(l,o,!0)),a.push(u)}}),{attrs:e,defaultStyle:t,body:a}},t.convertData=o,t.getDataName=i}]);